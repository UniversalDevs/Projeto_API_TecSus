<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Tecsus</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet"  type="text/css" href="" th:href="@{/css/energia_style.css}">

    <!-- Font Awesome JS -->

    <script scr="https://kit.fontawesome.com/eac8819838.js" crossorigin="anonymous"></script>

    <script type="text/javascript" src="" th:src="@{js/scripts.js}"></script>
    <script type="text/javascript" src="js/calculoImpostos.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css' rel='stylesheet'>

</head>

<body>
    
    <div class="wrapper">
        <!-- Sidebar  -->
        
        <nav id="sidebar">
            
          <div class="sidebar-header">
                  <img src="" th:src="@{/img/logo_tecsus_horizontal.png}" alt=""/>
                  <strong style="font-size: 20px; margin-bottom: -20px;"><p style="display: inline-block; font-weight: bold; color: #5652c7;">t</p><p style="display: inline-block; font-weight: bold; color: #74DB23">s</p></strong>
          </div>

          <ul class="list-unstyled components">

              <li>
                  <a href="#">
                      <i class="fas fa-home"></i>
                      Home
                  </a>
                   <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                          <i class="fas fa-file-invoice"></i>
                      Contas
                  </a>
                  <ul class="collapse list-unstyled" id="pageSubmenu" style="font-size: 1em;">
                      <li>
                          <a href="/energias">Energia</a>
                      </li>
                      <li>
                          <a href="/aguas">Água</a>
                      </li>
                      <li>
                          <a href="#">Gás</a>
                      </li>
                  </ul> 
                  
              </li>
              <li>
                  <a href="/administradores">
                      <i class="fas fa-users"></i>
                      Administradores
                  </a>
              </li>
              <li>
                  <a href="/clientes">
                      <i class="fas fa-users"></i>
                      Clientes
                  </a>
              </li>
              <li>
                  <a href="/concessionarias">
                      <i class="far fa-building"></i>
                      Concessionárias
                  </a>
              </li>
              <li>
                  <a href="/instalacoes">
                      <i class="fas fa-home "></i>
                      Instalação
                  </a>
              </li>
              <li>
                  <a href="/contratos">
                      <i class="fas fa-file-invoice"></i>
                      Contrato
                  </a>
              </li>
              <li>
                  <a href="#">
                      <i class="far fa-file-alt"></i>
                      Relatórios
                  </a>
              </li>

          </ul>
      </nav>


        <!-- Page Content  -->
        <div id="content">
            <button type="button" id="sidebarCollapse" class="btn btn-info">
                <i class="fas fa-bars" style="color: white;"></i>
            </button>

            <div class="form-group">

                <div class="linha1">
                    <p><span>Concessionária <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_nome}" readonly></span> <span style="float:right; margin-right: 15em;">CNPJ <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_cnpj}" readonly></span></p>
                    <p><span>Endereço <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_end}" readonly></span> <span style="float:right; margin-right: 15em;">I.E. <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_IE}" readonly></span></p>
                    <p><span>Caixa Postal <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_cxpst}" readonly></span> <span style="float:right; margin-right: 15em;">Insc. Única Reg. Esp. <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_inscricao_unica_reg}" readonly></span></p>
                    <p><span>CEP <input type="text" class="form-control" th:value="${contrato.concessionaria.conc_cep}" readonly></span></p>
                </div>
                <p style="margin-top: 5em; color: black; font-weight: bold; border-bottom: 3px solid #fd0000;">Cliente/Local de Consumo</p>
                <div class="linha1">
                    <p>
                        <span>Cliente 
                            <input type="text" class="form-control" th:value="${contrato.cliente.cli_nome}" readonly/>
                        </span> 
                        <span style="float:right; margin-right: 15em;">CNPJ/CPF 
                            <input type="text" class="form-control" th:value="${contrato.cliente.cli_cpf}" readonly/>
                        </span></p>                    
                    <p>
                        <span style="float: left;">Endereço 
                            <input type="text" style="width: 30em; margin-right:1em;" class="form-control" th:value="${contrato.endereco}" readonly/>
                        </span> 
                    </p>   
                    <p>
                        <span>CEP <input type="text" class="form-control" style="width:10em; margin-right: 1em;" th:value="${contrato.cep}" readonly/></span>
                        <span>Bairro <input type="text" class="form-control" style="width:15em; margin-right: 1em;"  th:value="${contrato.bairro}" readonly/></span>
                        <span>Cidade <input type="text" class="form-control" style="width:20em; margin-right: 1em;"  th:value="${contrato.cidade}" readonly/></span>
                        <span>Estado <input type="text" class="form-control" style="width:5em; margin-right: 1em;"  th:value="${contrato.estado}" readonly/></span>
                    </p>
                    <p>
                        <span>Grupo/Subgrupo <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.grupo_subgrupo}" readonly/></span>
                        <span>Classe/Subclasse <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.classe_subclasse}" readonly/></span>
                    </p>
                    <p>
                        <span>Cod. Identificador <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.codigo_identificador}" readonly/></span>
                        <span>Cod. Fiscal de Operação <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.codigo_fiscal_operacao}" readonly/></span>
                    </p> 
                    <p>
                        <span>Tensão Nominal <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.tensao_nominal}" readonly/></span>
                        <span>Roteiro de Leitura <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.roteiro_leitura}" readonly/></span>
                    </p>
                    <p>
                        <span>Nº Medidor <input type="text" class="form-control" style="width:20em; margin-right: 1em;" th:value="${instalacao.numero_medidor}" readonly/></span>
                    </p>    
                    <p style="margin-top: 5em; color: black; font-weight: bold; border-bottom: 3px solid #fd0000;">Dados da Conta</p>             
                    <p></p>
                    <!-- <p>
                        <button class="btn btn-danger" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                          Visualizar Conta
                        </button>
                    </p>
                      <div class="collapse" id="collapseExample">
                        <div class="card card-body">
                           <embed th:src="@{/download_conta}" type="application/pdf" width="700px" height="630px">
                        </div>
                      </div> -->
                      <button class="btn btn-danger" type="button" onclick="window.open('/download_conta','popUpWindow','height=800,width=600,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes');"  >
                        Visualizar Conta
                      </button>
                      <!-- <input type="button" class="form-control" value="Visualizar Conta" onclick="window.open('/download_conta','popUpWindow','height=800,width=600,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes');"> -->
                      <form th:action="@{'/energias/concessionarias/cliente/' + ${contrato.contrato_id} + '/' + ${contrato.cliente.cli_id} + '/conta/' + ${instalacao.codigo_identificador} + '/novo'}" method="post">

                          <div class="linha1" >
                            <p><span>Ano</span></p>
                            <select class="form-select form-select-sm"  style="width: 10em;" name="ano">
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                <option value="2019">2019</option>
                                <option value="2020">2020</option>
                                <option value="2021">2021</option>
                                <option value="2021">2022</option>
                            </select>             
                        </div>
                        <div class="linha1" >
                            <p><span>Mês</span></p>
                            <select class="form-select form-select-lg" style="width: 10em;" name="mes">
                                <option value="Janeiro">Janeiro</option>
                                <option value="Fevereiro">Fevereiro</option>
                                <option value="Março">Março</option>
                                <option value="Abril">Abril</option>
                                <option value="Maio">Maio</option>
                                <option value="Junho">Junho</option>
                                <option value="Julho">Julho</option>
                                <option value="Agosto">Agosto</option>
                                <option value="Setembro">Setembro</option>
                                <option value="Outubro">Outubro</option>
                                <option value="Novembro">Novembro</option>
                                <option value="Dezembro">Dezembro</option>
                            </select>             
                        </div>
                        <div class="linha1">
                            <p style="float: right;"><span style="float:right; margin-right: 15em;">Conta Do Mês <input type="text" name="mes_referencia" class="form-control" style="border: 1px solid gray;"></span></p>

                            <p style="color: red;">
                                <span >Valor Total A Pagar <input type="number" name="valor_total_a_pagar" class="form-control" style="width:15em; margin-right: 1em;"></span>
                                <span>Número da Instalação <input type="text" th:value="${instalacao.codigo_identificador}" class="form-control" style="width:15em; margin-right: 1em;" readonly></span>
                            </p>
                            <p style="color: red;">
                                <span>Consumo Mês/ kWh <input type="number" name="consumo_mes_kwh" class="form-control" style="width:15em; margin-right: 1em;"></span>
                                <span>Data de Vencimento  <input type="text" name ="data_de_vencimento" class="form-control" style="width:15em; margin-right: 1em;"></span>
                            </p>
                            <p style="float:center;">
                                <a class="btn btn-secondary" data-toggle="collapse" href="#multiCollapseExample1" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Período de Faturamento</a>
                                <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#multiCollapseExample2" aria-expanded="false" aria-controls="multiCollapseExample2">Bandeiras Tarifárias</button>
                            </p>
                              <div class="row">
                                <div class="col">
                                  <div class="collapse multi-collapse" id="multiCollapseExample1">
                                    <div class="card card-body">
                                        <p>
                                        <p>
                                            <span>Data de Emissão <input type="text" name="data_emissão" class="form-control" style="width:10em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>                                
                                            <span>Leitura Anterior <input type="text" name="leitura_anterior" class="form-control" style="width:10em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                        </p>
                                        <p>
                                            <span>Leitura Atual <input type="text" name="leitura_atual" class="form-control" style="width:10em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                            <span>Próxima Leitura <input type="text" name="proxima_leitura" class="form-control" style="width:10em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                            <span>Nº Dias De Faturamento <input type="text" name="dias_faturamento" class="form-control" style="width:10em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                        </p>                                
                                    </div>
                                  </div>
                                </div>
                                <div class="col">
                                  <div class="collapse multi-collapse" id="multiCollapseExample2">
                                    <div class="card card-body">
                                        <p>
                                            <span>Bandeira Tarifária Vigente <input type="text" class="form-control" name="bandeira_tarifaria" style="width:15em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                        </p>
                                        <p>
                                            <span>Data Início <input type="text" name="data_inicio" class="form-control" style="width:15em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                        </p>
                                        <p>    
                                            <span>Data Término <input type="text" name="data_termino" class="form-control" style="width:15em; margin-right: 1em; border: 1px solid rgb(56, 56, 56);"></span>
                                        </p>                                
                                    </div>
                                  </div>
                                </div>
                              </div>
                               <p style="color:black;background-color:rgb(163, 163, 163); text-align: center; width: 50em;">Descrição de Consumo</p>
                               <p>
                                <span>Const.Mult. <input type="number" name="const_mult" class="form-control" style="width:15em; margin-right: 1em;"></span>
                                <span>Qtde. kWh mês <input type="number" name="qtde_kwh_mes" class="form-control" style="width:15em; margin-right: 1em;"></span>
                                <span>Leitura Anterior <input type="number" name="valor_leitura_anterior" class="form-control" style="width:15em; margin-right: 1em;"></span>
                                <span>Leitura Atual <input type="number" name="valor_leitura_atual" class="form-control" style="width:15em; margin-right: 1em;"></span>
                               </p>
                               <p style="color:black;background-color:rgb(163, 163, 163); text-align: center; width: 50em;">Detalhes de Faturamento</p>
                               <table class="table">
                                <thead>
                                  <tr>
                                    <th scope="col">Descrição do Produto</th>
                                    <th scope="col">Quantidade</th>
                                    <th scope="col">Tarifa Aplicada</th>
                                    <th scope="col">Valor Fonec</th>
                                    <th scope="col">Tarifa c/ Impostos</th>
                                    <th scope="col">B. CALC. ICMS</th>
                                    <th scope="col">B. CALC. PIS/COFINS</th>
    
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <th scope="row">TUSD - Consumo</th>
                                    <td><input type="number" step="0.01" name="tusd_qtd_kwh" class="form-control" style="width:10em; margin-right: 1em;" id="quantidade" oninput="calculoFornecimento()"></td>
                                    <td><input type="number" step="0.01" name="tusd_tarifa_aplicada" class="form-control" style="width:10em; margin-right: 1em;" id="calculoFornecimento2" oninput="calculoFornecimento()"></td>
                                    <td><input type="number" step="0.01" name="tusd_valor_fornec" class="form-control" style="width:10em; margin-right: 1em;" id="totalFornecimento" readonly></td>
                                    <td><input type="number" step="0.01" name="tusd_tarifa_imposto" class="form-control" style="width:10em; margin-right: 1em;"id="imposto" oninput="calculoBcalc()"></td>
                                    <td><input type="number" step="0.01" name="tusd_bcalc_icms" class="form-control" style="width:10em; margin-right: 1em;" id="bcalc_icms" readonly></td>
                                    <td><input type="number" step="0.01" name="tusd_bcalc_piscofins" class="form-control" style="width:10em; margin-right: 1em;" id="bcalc_pis_cofins" readonly></td>
                                  </tr>
                                </tbody>
                              </table>
                              <table class="table">
                                  <tbody>
                                    <th scope="row">Itens Financeiros</th>
                                    <td><input type="number" step="0.01" name="contribuicao_municipal_valor" class="form-control" style="width:10em; margin-right: 1em;" id="itens_financeiros" oninput="itens()"></td>
                                  </tbody>
                              </table>
    
                              <table class="table table-hover">
                                <thead style="background-color: rgb(255, 0, 0); color: white;">
                                  <tr>
                                    <th scope="col">Descrição</th>
                                    <th scope="col">Base de Cálculo</th>
                                    <th scope="col">Aliquota(%)</th>
                                    <th scope="col">Valor(R$)</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <th scope="row">PIS</th>
                                    <td><input type="number" step="0.01" name="pis_bcalc" class="form-control" style="width:10em; margin-right: 1em;" id="bcalc_pis" readonly></td>
                                    <td><input type="number" step="0.01" name="pis_aliqota" class="form-control" style="width:10em; margin-right: 1em;" id="aliquota_pis" oninput="calculoAliquota()"></td>
                                    <td><input type="number" step="0.01" name="pis_valor" class="form-control" style="width:10em; margin-right: 1em;" id="valor_pis" readonly></td>
                                  </tr>
                                  <tr>
                                    <th scope="row">COFINS</th>
                                    <td><input type="number" step="0.01" name="cofins_bcalc" class="form-control" style="width:10em; margin-right: 1em;" id="bcalc_cofins" readonly></td>
                                    <td><input type="number" step="0.01" name="cofins_aliqota" class="form-control" style="width:10em; margin-right: 1em;" id="aliquota_cofins" oninput="calculoAliquota()"></td>
                                    <td><input type="number" step="0.01" name="cofins_valor" class="form-control" style="width:10em; margin-right: 1em;" id="valor_cofins" readonly></td>
                                  </tr>
                                  <tr>
                                    <th scope="row">ICMS</th>
                                    <td><input type="number" step="0.01" name="icms_bcalc" class="form-control" style="width:10em; margin-right: 1em;" id="bcalc_icm" readonly></td>
                                    <td><input type="number" step="0.01" name="icms_aliqota" class="form-control" style="width:10em; margin-right: 1em;" id="aliquota_icms" oninput="calculoAliquota()"></td>
                                    <td><input type="number" step="0.01" name="icms_valor" class="form-control" style="width:10em; margin-right: 1em;" id="valor_icms" readonly></td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                          <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#exampleModal" style="margin-left: 25em; width: 20em; font-size: 20px;">
                            Salvar
                          </button>
                           <!-- Modal -->
              <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Deseja salvar essas alterações?</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      Caso deseje salvar os dados cadastrados, aperte em "Salvar". Caso contrario pressione "Cancelar".
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                      <input type="submit" value="Salvar" class="btn btn-success" style="margin-left: 30em;">
                    </div>
                  </div>
                </div>
              </div>
    </div>
                      </form>
                      
                </div>
            </div>
              
             
    
    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
            });
        });
        
        function calculoFornecimento()
        {
            calculoFornecimento1 = document.getElementById("quantidade").value;
            calculoFornecimento2 = document.getElementById("calculoFornecimento2").value;
            document.getElementById("totalFornecimento").value = calculoFornecimento1 * calculoFornecimento2;
        }

        function calculoBcalc()
        {
            calculoBcalc1 = document.getElementById("quantidade").value;
            calculoBcalc2 = document.getElementById("imposto").value;
            document.getElementById("bcalc_icms").value = calculoBcalc1 * calculoBcalc2;
            document.getElementById("bcalc_pis_cofins").value = calculoBcalc1 * calculoBcalc2;
            document.getElementById("bcalc_pis_cofins").value = calculoBcalc1 * calculoBcalc2;
        }

        function itens()
        {
            itensFinanceiros = document.getElementById("itens_financeiros").value;
            bcalc = document.getElementById("bcalc_pis_cofins").value;
            document.getElementById("bcalc_pis").value =  parseFloat(itensFinanceiros) + parseFloat(bcalc);
            document.getElementById("bcalc_cofins").value = parseFloat(itensFinanceiros) + parseFloat(bcalc);
            document.getElementById("bcalc_icm").value = parseFloat(itensFinanceiros) + parseFloat(bcalc);
        }

        function calculoAliquota(){
            calculoAliquota1 = document.getElementById("bcalc_pis").value;
            calculoAliquota2 = document.getElementById("aliquota_pis").value;
            calculoAliquota3 = document.getElementById("aliquota_cofins").value;
            calculoAliquota4 = document.getElementById("aliquota_icms").value;
            document.getElementById("valor_pis").value = calculoAliquota1 * (calculoAliquota2/100);
            document.getElementById("valor_cofins").value = calculoAliquota1 * (calculoAliquota3/100);
            document.getElementById("valor_icms").value = calculoAliquota1 * (calculoAliquota4/100);

        }
    </script>
</body>
</html>
<!-- https://www.youtube.com/watch?v=ctwRpskAeIU&t=1434s -->
<!-- 01:15:49 -->